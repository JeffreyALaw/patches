diff --git a/gcc/ext-dce.cc b/gcc/ext-dce.cc
index c94d1fc3414..08a111b34cc 100644
--- a/gcc/ext-dce.cc
+++ b/gcc/ext-dce.cc
@@ -706,7 +706,7 @@ ext_dce_process_uses (rtx_insn *insn, rtx obj,
 		    {
 		      /* For anything but (subreg (reg)), break the inner loop
 			 and process normally (conservatively).  */
-		      if (!REG_P (SUBREG_REG (y)))
+		      if (!REG_P (SUBREG_REG (y)) || SUBREG_PROMOTED_VAR_P (y))
 			break;
 		      bit = subreg_lsb (y).to_constant ();
 		      if (dst_mask)
@@ -785,6 +785,11 @@ ext_dce_process_uses (rtx_insn *insn, rtx obj,
 	  HOST_WIDE_INT size = GET_MODE_BITSIZE (GET_MODE (x)).to_constant ();
 	  HOST_WIDE_INT rn = 4 * REGNO (SUBREG_REG (x));
 
+	  /* If this is a promoted subreg, then more of it may be live than
+	     is otherwise obvious.  */
+	  if (SUBREG_PROMOTED_VAR_P (x))
+	    size = GET_MODE_BITSIZE (GET_MODE (SUBREG_REG (x))).to_constant ();
+
 	  bitmap_set_bit (livenow, rn);
 	  if (size > 8)
 	    bitmap_set_bit (livenow, rn + 1);
diff --git a/gcc/testsuite/gcc.dg/torture/pr116039.c b/gcc/testsuite/gcc.dg/torture/pr116039.c
new file mode 100644
index 00000000000..d67b9326de7
--- /dev/null
+++ b/gcc/testsuite/gcc.dg/torture/pr116039.c
@@ -0,0 +1,20 @@
+/* { dg-do run } */
+/* { dg-additional-options "-fsigned-char -fno-strict-aliasing -fwrapv" } */
+
+extern void abort (void);
+
+int c[12];
+char d[12];
+int *f = c;
+int *z = (int *)1;
+long long y;
+int main() {
+  c[9] = 0xff;
+  for (int i = 0; i < 12; i += 3)
+    d[9] = z ? f[i] : 0;
+  for (long i = 0; i < 12; ++i)
+    y ^= d[i];
+  if (y != -1)
+    abort ();
+  return 0;
+}
