diff --git a/gcc/config/riscv/riscv.cc b/gcc/config/riscv/riscv.cc
index 7d723fc4d695..7d53d3ac0104 100644
--- a/gcc/config/riscv/riscv.cc
+++ b/gcc/config/riscv/riscv.cc
@@ -14189,6 +14189,7 @@ riscv_extend_to_xmode_reg (rtx x, machine_mode mode, enum rtx_code rcode)
 {
   gcc_assert (rcode == ZERO_EXTEND || rcode == SIGN_EXTEND);
 
+#if 0
   rtx xmode_reg = gen_reg_rtx (Xmode);
 
   if (CONST_INT_P (x))
@@ -14219,9 +14220,13 @@ riscv_extend_to_xmode_reg (rtx x, machine_mode mode, enum rtx_code rcode)
   else if (mode == Xmode)
     return x;
   else
-    riscv_emit_unary (rcode, xmode_reg, x);
+#endif
+  rtx t = convert_modes (Xmode, mode, x, rcode == ZERO_EXTEND);
+  return force_reg (Xmode, t);
 
+#if 0
   return xmode_reg;
+#endif
 }
 
 /* Implements the unsigned saturation add standard name usadd for int mode.
